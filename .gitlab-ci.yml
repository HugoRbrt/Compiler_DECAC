# Gitlab ci/cd file configuration 

stages:
    - compiling
    - testing
    - cleanup

services:
    - docker:dind

compile_job:
    stage: compiling
    image: docker:dind
    script:
        - echo "Trying to compile src files..."
        - docker build .
        - mvn compile

test_compile_job:
    stage: compiling
    script:
        - echo "Trying to compile test files..."

script_execution_job:
    dependencies:
        - compile_job
        - test_compile_job
    stage: testing
    script:
        - echo "A ce niveau là, on devrait réussir à lancer les tests"
        
no_regression_job:
    dependencies:
        - compile_job
        - test_compile_job
    stage: testing
    script:
        - echo "A ce niveau là, on devrait pouvoir lancer les tests de non-régression"



cleanup_job:
    stage: cleanup
    script:
        - mvn clean
    when: on_failure
